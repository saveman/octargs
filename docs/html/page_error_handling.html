<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>octargs-doxygen: Error Handling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">octargs-doxygen
   &#160;<span id="projectnumber">0.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Error Handling </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#section_help_errors_overview">Error handling</a></li>
</ul>
</div>
<div class="textblock"><p>Handling configuration and parsing errors</p>
<h1><a class="anchor" id="section_help_errors_overview"></a>
Error handling</h1>
<p>The library uses exceptions to report errors. All exceptions are derived from std::exception subclasses and try to follow the C++ standard.</p>
<p>First type of exceptions thrown are these related to invalid use of the API or bad setup of the parser. Such exception in normal case mean that the application code must be fixed:</p>
<ul>
<li><a class="el" href="classoct_1_1args_1_1invalid__argument__name.html">oct::args::invalid_argument_name</a> - thrown when given argument name is invalid (is duplicated, contains invalid characters, etc.). </li>
<li><a class="el" href="classoct_1_1args_1_1conversion__error.html">oct::args::conversion_error</a> - thrown when conversion failed (and was requested by the user; when parser is converting the value it wraps this exception with parser_error) </li>
<li><a class="el" href="classoct_1_1args_1_1missing__converter.html">oct::args::missing_converter</a> - thrown when conversion function is missing (and parser needs to convert the value provided by user) </li>
<li><a class="el" href="classoct_1_1args_1_1subparser__positional__conflict.html">oct::args::subparser_positional_conflict</a> - thrown when there is a conflict between positional and/or subparser arguments (by design parser does not handle both subparser and positional arguments, or two subparsers in a single instance) </li>
<li><a class="el" href="classoct_1_1args_1_1unknown__argument.html">oct::args::unknown_argument</a> - thrown when unknown argument was requested (e.g. results were requested for argument that was never registered)</li>
</ul>
<p>Second type of exception are these thrown by parser when input cannot be parsed correctly, because for example it contains invalid arguments names or required values are missing. The <a class="el" href="classoct_1_1args_1_1parser__error.html">oct::args::parser_error</a> has a member with <a class="el" href="namespaceoct_1_1args.html#ac13536336869ab1ff4fe666c6c5abeb3">oct::args::parser_error_code</a> describing what exactly happened.</p>
<ul>
<li><a class="el" href="classoct_1_1args_1_1parser__error.html">oct::args::parser_error</a> - thrown when parsing cannot be performed</li>
</ul>
<p>As parser supports different types of character types (char, wchar_t, ...) to provide easy to use and valuable exceptions the details like the invalid argument name is also stored in the exception. To make it possible the extended exceptions were created which are templates. For example:</p>
<ul>
<li><a class="el" href="classoct_1_1args_1_1parser__error__ex.html">oct::args::parser_error_ex</a> - contains name and value members that are used to store the name and value that caused the problem.</li>
</ul>
<p>Example of error handling:</p>
<div class="fragment"><div class="line">    <span class="keywordflow">try</span></div><div class="line">    {</div><div class="line">        <span class="keyword">auto</span> <a class="code" href="namespaceoct_1_1args.html#a95022bc18df1cf0eaeec710afd452580">results</a> = arg_parser.parse(argc, argv);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> requested_order = <a class="code" href="namespaceoct_1_1args.html#a95022bc18df1cf0eaeec710afd452580">results</a>.get_first_value(<span class="stringliteral">&quot;--order&quot;</span>);</div><div class="line">        <span class="keyword">auto</span> files = <a class="code" href="namespaceoct_1_1args.html#a95022bc18df1cf0eaeec710afd452580">results</a>.get_values(<span class="stringliteral">&quot;files&quot;</span>);</div><div class="line"></div><div class="line">        <span class="comment">// TODO: application logic</span></div><div class="line">    }</div><div class="line">    <span class="keywordflow">catch</span> (<span class="keyword">const</span> parser_error_ex&lt;char&gt;&amp; e)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">switch</span> (e.get_error_code())</div><div class="line">        {</div><div class="line">        <span class="keywordflow">case</span> parser_error_code::CONVERSION_FAILED:</div><div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Cannot convert value &#39;&quot;</span> &lt;&lt; e.get_value() &lt;&lt; <span class="stringliteral">&quot;&#39; for argument &#39;&quot;</span> &lt;&lt; e.get_name() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span></div><div class="line">                      &lt;&lt; std::endl;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> parser_error_code::TOO_MANY_OCCURRENCES:</div><div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Argument &#39;&quot;</span> &lt;&lt; e.get_name() &lt;&lt; <span class="stringliteral">&quot;&#39; provided too many times&quot;</span> &lt;&lt; std::endl;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> parser_error_code::SYNTAX_ERROR:</div><div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Syntax error - cannot parse: &#39;&quot;</span> &lt;&lt; e.get_value() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; std::endl;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="comment">// TODO: other</span></div><div class="line"></div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Cannot parse input arguments&quot;</span> &lt;&lt; std::endl;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e)</div><div class="line">    {</div><div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;FATAL error: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div><div class="line">    }</div></div><!-- fragment --><p> Full code:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;octargs/octargs.hpp&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">    <span class="keyword">using namespace </span><a class="code" href="namespaceoct_1_1args.html">oct::args</a>;</div><div class="line"></div><div class="line">    <span class="keyword">enum class</span> order</div><div class="line">    {</div><div class="line">        ascending,</div><div class="line">        descending</div><div class="line">    };</div><div class="line">    <span class="keyword">struct </span>order_converter</div><div class="line">    {</div><div class="line">        order operator()(<span class="keyword">const</span> std::string&amp; value)<span class="keyword"> const</span></div><div class="line"><span class="keyword">        </span>{</div><div class="line">            <span class="keywordflow">if</span> (value == <span class="stringliteral">&quot;asc&quot;</span>)</div><div class="line">                <span class="keywordflow">return</span> order::ascending;</div><div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value == <span class="stringliteral">&quot;desc&quot;</span>)</div><div class="line">                <span class="keywordflow">return</span> order::descending;</div><div class="line">            <span class="keywordflow">throw</span> <a class="code" href="classoct_1_1args_1_1conversion__error__ex.html">conversion_error_ex&lt;char&gt;</a>(value);</div><div class="line">        }</div><div class="line">    };</div><div class="line"></div><div class="line">    <a class="code" href="classoct_1_1args_1_1basic__parser.html">parser</a> arg_parser;</div><div class="line">    arg_parser.add_valued({ <span class="stringliteral">&quot;--order&quot;</span> })</div><div class="line">        .set_min_count(1)</div><div class="line">        .set_allowed_values({ <span class="stringliteral">&quot;asc&quot;</span>, <span class="stringliteral">&quot;desc&quot;</span> })</div><div class="line">        .set_default_value(<span class="stringliteral">&quot;asc&quot;</span>)</div><div class="line">        .set_type&lt;order&gt;()</div><div class="line">        .set_convert_function(order_converter());</div><div class="line">    arg_parser.add_positional(<span class="stringliteral">&quot;files&quot;</span>).set_max_count_unlimited();</div><div class="line"></div><div class="line">    <span class="keywordflow">try</span></div><div class="line">    {</div><div class="line">        <span class="keyword">auto</span> <a class="code" href="classoct_1_1args_1_1basic__results.html">results</a> = arg_parser.parse(argc, argv);</div><div class="line"></div><div class="line">        <span class="keyword">auto</span> requested_order = <a class="code" href="classoct_1_1args_1_1basic__results.html">results</a>.get_first_value(<span class="stringliteral">&quot;--order&quot;</span>);</div><div class="line">        <span class="keyword">auto</span> files = <a class="code" href="classoct_1_1args_1_1basic__results.html">results</a>.get_values(<span class="stringliteral">&quot;files&quot;</span>);</div><div class="line"></div><div class="line">        <span class="comment">// TODO: application logic</span></div><div class="line">    }</div><div class="line">    <span class="keywordflow">catch</span> (<span class="keyword">const</span> <a class="code" href="classoct_1_1args_1_1parser__error__ex.html">parser_error_ex&lt;char&gt;</a>&amp; e)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">switch</span> (e.get_error_code())</div><div class="line">        {</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceoct_1_1args.html#ac13536336869ab1ff4fe666c6c5abeb3ae1382465cfba6130c05d8b7ea77aa498">parser_error_code::CONVERSION_FAILED</a>:</div><div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Cannot convert value &#39;&quot;</span> &lt;&lt; e.get_value() &lt;&lt; <span class="stringliteral">&quot;&#39; for argument &#39;&quot;</span> &lt;&lt; e.get_name() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span></div><div class="line">                      &lt;&lt; std::endl;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceoct_1_1args.html#ac13536336869ab1ff4fe666c6c5abeb3a87824d807e6ce7af5c7c012fe68d9ee4">parser_error_code::TOO_MANY_OCCURRENCES</a>:</div><div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Argument &#39;&quot;</span> &lt;&lt; e.get_name() &lt;&lt; <span class="stringliteral">&quot;&#39; provided too many times&quot;</span> &lt;&lt; std::endl;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceoct_1_1args.html#ac13536336869ab1ff4fe666c6c5abeb3a756ec3dd26d1a73363eb3e68b6e820df">parser_error_code::SYNTAX_ERROR</a>:</div><div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Syntax error - cannot parse: &#39;&quot;</span> &lt;&lt; e.get_value() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; std::endl;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">            <span class="comment">// TODO: other</span></div><div class="line"></div><div class="line">        <span class="keywordflow">default</span>:</div><div class="line">            std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Cannot parse input arguments&quot;</span> &lt;&lt; std::endl;</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e)</div><div class="line">    {</div><div class="line">        std::cerr &lt;&lt; <span class="stringliteral">&quot;FATAL error: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
