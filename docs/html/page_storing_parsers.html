<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>octargs-doxygen: Storing parsers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">octargs-doxygen
   &#160;<span id="projectnumber">0.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Storing parsers </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#section_help_type_handlers">Type handlers</a></li>
<li class="level1"><a href="#section_help_storing_parsers">Storing parsers</a><ul><li class="level2"><a href="#section_help_defining_storage_type">Defining the storage type</a></li>
<li class="level2"><a href="#section_help_defining_parser_type">Defining the parser type</a></li>
<li class="level2"><a href="#section_help_setting_arg_type">Settings arguments type and storage</a></li>
<li class="level2"><a href="#section_help_parsing_storage">Parsing and storing the results</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>Parsers that store parsed values in a user defined storage object</p>
<h1><a class="anchor" id="section_help_type_handlers"></a>
Type handlers</h1>
<p>One of the useful features of the library is the ability to store values of the parsed arguments in an object provided by the user so a single call to parse is often enough to fill the whole data structure and start doing the main job.</p>
<p>For each argument is is possible to define its type (see: <a class="el" href="page_argument_configuration.html#section_help_type_std">Value type - Standard types</a>). Setting the type constructs a type handler object and attaches it to the argument.</p>
<div class="fragment"><div class="line">arg_parser.add_valued({ <span class="stringliteral">&quot;--lines&quot;</span> }).set_type&lt;int&gt;();</div></div><!-- fragment --><p>The handler has three 'hooks' (functions) which could be set.</p>
<ul>
<li>convert - used to convert string representation to the requested type </li>
<li>check - used to check if the parsed and converted value is correct (e.g. it could check if value is in some predefined range) </li>
<li>store - used to store the parsed and converted value</li>
</ul>
<p>When the argument type is set using set_type() method only the convert function is set (if not given by the user then default converter class is used). There is also a second way to set the type: set_type_and_storage() - this version sets both convert and store function. As it uses the automatic type deduction in many cases it is enough to provide the storage location (e.g. member of a storage object, details described in other section) and the rest is done automatically.</p>
<div class="fragment"><div class="line">arg_parser.add_switch({ <span class="stringliteral">&quot;-E&quot;</span>, <span class="stringliteral">&quot;--show-ends&quot;</span> })</div><div class="line">    .set_description(<span class="stringliteral">&quot;display $ at end of each line&quot;</span>)</div><div class="line">    .set_type_and_storage(&amp;cat_app_settings::m_print_line_ends);</div></div><!-- fragment --><h1><a class="anchor" id="section_help_storing_parsers"></a>
Storing parsers</h1>
<p>To provide maximum flexibility with minimum amount of code the storing parsers were added to the library. While using standard parsers normally the results object is used to get the argument values. With the storing parser the standard way of handling arguments is to use the set_type_and_storage() method of an argument.</p>
<p>The steps to follow when using storing parsers are described in next sections.</p>
<h2><a class="anchor" id="section_help_defining_storage_type"></a>
Defining the storage type</h2>
<p>Storage type is a type that will be used to store the argument values. For example:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>data_storage</div><div class="line">{</div><div class="line">    data_storage()</div><div class="line">        : m_help_requested(false)</div><div class="line">        , m_verbose(false)</div><div class="line">        , m_lines(10)</div><div class="line">    {</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordtype">bool</span> m_help_requested;</div><div class="line">    <span class="keywordtype">bool</span> m_verbose;</div><div class="line">    <span class="keywordtype">int</span> m_lines;</div><div class="line">    std::string m_header;</div><div class="line">    std::vector&lt;std::string&gt; m_files;</div><div class="line">};</div></div><!-- fragment --><h2><a class="anchor" id="section_help_defining_parser_type"></a>
Defining the parser type</h2>
<p>When the storage type is defined then we are ready to define the parser type:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> my_parser = storing_parser&lt;data_storage&gt;;</div></div><!-- fragment --><h2><a class="anchor" id="section_help_setting_arg_type"></a>
Settings arguments type and storage</h2>
<p>Next step is to tell the arguments where to store the values (and implicitly: what is the type of the argument).</p>
<div class="fragment"><div class="line">        my_parser <a class="code" href="namespaceoct_1_1args.html#a308b9c26c72b6fa5b2ca07a67c479df4">parser</a>;</div><div class="line"></div><div class="line">        parser.add_exclusive({ <span class="stringliteral">&quot;--help&quot;</span> }).set_type_and_storage(&amp;data_storage::m_help_requested);</div><div class="line">        parser.add_switch({ <span class="stringliteral">&quot;--verbose&quot;</span> }).set_type_and_storage(&amp;data_storage::m_verbose);</div><div class="line">        parser.add_valued({ <span class="stringliteral">&quot;--lines&quot;</span> }).set_type_and_storage(&amp;data_storage::m_lines);</div><div class="line">        parser.add_valued({ <span class="stringliteral">&quot;--header&quot;</span> }).set_type_and_storage(&amp;data_storage::m_header);</div><div class="line">        parser.add_positional(<span class="stringliteral">&quot;files&quot;</span>).set_max_count_unlimited().set_type_and_storage(&amp;data_storage::m_files);</div></div><!-- fragment --><h2><a class="anchor" id="section_help_parsing_storage"></a>
Parsing and storing the results</h2>
<p>With the parser prepared as described above the usage is very simple:</p>
<div class="fragment"><div class="line">        data_storage data;</div><div class="line">        parser.parse(argc, argv, data);</div></div><!-- fragment --><p> And if there were no errors the data object is now filled with the values and ready to use! </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
